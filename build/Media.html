<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Media : Okanjo API Core Specification</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="assets_/css/shCore.css">
        <link rel="stylesheet" href="assets_/css/shThemeDefault.css">
        <link rel="stylesheet" href="assets_/css/main.css">
    </head>
    <body data-root-path="">
        <div id="wrapper">
            <div id="content">

<ul id="topnav">
    <li><a href="index.html">Index</a></li>
    <li><a href="#toc">TOC</a></li>
</ul>
<h1 id="media">Media</h1>

<p>This is where things get interesting.</p>

<p>Media Images are currently the only format supported by the API.</p>

<p>Currently, media can only be obtained as an embed on an object. In the future, we plan to allow access to all
user-uploaded media for management and re-use.</p>

<h1 id="objects">Objects</h1>

<ul>
<li><a href="Objects.html#Media"><code>Media</code></a> – Media object</li>
</ul>

<h2 id="tableofcontentsahreftocnametocclassdeeplinka">Table of Contents <a href="#toc" name="toc" class="deep-link">#</a></h2>

<ul>
<li><a href="#Media Embeds">Media Embeds</a></li>
<li><a href="#POST /media">POST /media</a></li>
<li><a href="#GET /media/generate">GET /media/generate</a></li>
</ul>

<h2 id="mediaembedsahrefmediaembedsidmediaembedsclassdeeplinka">Media Embeds <a href="#Media Embeds" id="Media Embeds" class="deep-link">#</a></h2>

<p>Embedded Media format on resources by attaching media elements as associative objects. For example:</p>

<pre class="brush:js">

"media": {
    "ID": {
        "original": "URI",

        "{SIZE}_{FORMAT}": "URI",

        "{SIZE}_{FORMAT}_width": "URI",

        "{SIZE}_{FORMAT}_height": "URI",

 ...
    }
}
</pre>

<dl class="inline-def"><dt><p><code>id</code></p></dt><dd><p><code>int</code>  The unique ID of the media image.</p></dd><dt><p><code>original</code></p></dt><dd><p><code>string</code>  The URI of the original image as uploaded by the owner. The image may be scaled down.</p></dd><dt><p><code>size</code></p></dt><dd><p><code>string</code>  The platform the image is sized/cropped for. Returned options depend on purpose. See <a href="Constants.html#MediaImageConstants">MediaImageConstants</a>.</p></dd><dt><p><code>format</code></p></dt><dd><p><code>string</code>  The formatting of the image. See <a href="Constants.html#MediaImageConstants">MediaImageConstants</a>.</p></dd><dt><p><code>width</code></p></dt><dd><p><code>int</code> Nullable. The width of the image. Populated after the image is generated.</p></dd><dt><p><code>height</code></p></dt><dd><p><code>int</code> Nullable. The height of the image. Populated after the image is generated.</p></dd></dl>

<p>Only the relevant size<em>format keys will be returned when embedded on resources. For example, on a <a href="Objects.html#Cause"><code>Cause</code></a> object, cart</em>desktop would not be included.</p>

<p>An example of media embedded on a <a href="Objects.html#Cause"><code>Cause</code></a> object:</p>

<pre class="brush:js">

"media": {
    "922": {
        "original": "https://.../dev_922_desktop_original.png_188kr9.png",

        "banner_desktop": "https://.../dev_922_desktop_banner.png_yboug.png"
        "banner_desktop_width": "1074"
        "banner_desktop_height": "808"
    },
    "923": {
        "original": "https://.../dev_923_desktop_original.jpg_v086e.jpg",

        "avatar_desktop": "https://.../dev_923_desktop_avatar.jpg_rt6tx.jpg"
        "avatar_desktop_width": "1074"
        "avatar_desktop_height": "808"

        "detail_desktop": "https://21e982ec2b1aac0deb9...561ffb73b3904fcb.ssl.cf1.rackcdn.com/dev_ufq6r_228359_desktop_detail.jpg",
        "detail_desktop_width": "1074",
        "detail_desktop_height": "808",

        "detail_mobile_retina": "https://dev-api.okanjo.com/media/generate?id=228359&format=mobile_retina&size=detail",
        "detail_mobile_retina_width": null,
        "detail_mobile_retina_height": null,
    }
}
</pre>

<h3 id="sizedescriptions">Size Descriptions</h3>

<p>See also <a href="Constants.html#MediaImageConstants">MediaImageConstants</a>.</p>

<dl class="inline-def"><dt><p><code>original</code></p></dt><dd><p>The original image provided by the user, as-is.</p></dd><dt><p><code>listing</code></p></dt><dd><p><code>Product</code> Used on product cards. Variable-sized. Scaled to best fit and cropped from the middle to completely fill the bounds.</p></dd><dt><p><code>listing_fixed</code></p></dt><dd><p><code>Product</code> Used on product cards. Fixed-sized square. Scaled to best fit and cropped from the middle to completely fill the bounds.</p></dd><dt><p><code>detail</code></p></dt><dd><p><code>Product</code> Used in the product image viewer on the detail view. This is not the full-size image. Scaled and matted.</p></dd><dt><p><code>thumbnail</code></p></dt><dd><p><code>Product</code> Used to show the thumbnail on file uploads and managing products (e.g. listing all image.) Scaled and matted.</p></dd><dt><p><code>cart</code></p></dt><dd><p><code>Product</code> Used on the shopping cart view. Scaled and matted.</p></dd><dt><p><code>avatar</code></p></dt><dd><p><code>User</code>, <code>Cause</code> Profile image. Square. Scaled to best fit and cropped from the middle to completely fill the bounds.</p></dd><dt><p><code>banner</code></p></dt><dd><p><code>Store</code>, <code>Cause</code> Store header banner image. Scaled to best fit and cropped from the top.</p></dd><dt><p><code>gallery</code></p></dt><dd><p><code>Product</code> Mobile full-size image.</p></dd></dl>

<h1 id="routes">Routes</h1>

<h2 id="postmediaahrefpostmediaidpostmediaclassdeeplinka">POST /media <a href="#POST /media" id="POST /media" class="deep-link">#</a></h2>

<p>Resource. Uploads a new media image to the server. Expects multi-part message encoding. <strong>Requires user level authentication.</strong></p>

<p>Only one media image may be uploaded per request.</p>

<blockquote>
  <p><em>* Note: Entities should not included during the API signature generation. *</em></p>
</blockquote>

<h3 id="queryparameters">Query Parameters</h3>

<dl class="inline-def"><dt><p><code>purpose</code></p></dt><dd><p><code>string</code> Used to associate the upload with a specific use. Used with the id parameter. See <a href="Constants.html#MediaImageConstants">MediaImageConstants</a>.</p></dd><dt><p><code>id</code></p></dt><dd><p><code>int</code> Optional. Used in conjunction with purpose to assign what object the image is to be associated with.</p></dd><dt><p><code>filename</code></p></dt><dd><p><code>string</code> The user-given name of the file being uploaded.</p></dd><dt><p><code>upload_checksum</code></p></dt><dd><p><code>string</code> The MD5 checksum of the file being uploaded. Used to prevent man-in-the-middle modification of the file.</p></dd></dl>

<h3 id="entitybody">Entity Body</h3>

<p><strong>Note: Send only <a href="http://tools.ietf.org/html/rfc2388">multi-part form data</a> to this request.</strong></p>

<dl class="inline-def"><dt><p><code>file</code></p></dt><dd><p><code>binary</code> The raw binary content of the file. 8MB maximum.</p></dd></dl>

<h3 id="returns">Returns</h3>

<p><a href="Objects.html#Media"><code>Media</code></a> object.</p>

<h3 id="errors">Errors</h3>

<dl><dt><p><strong>400 Bad Request</strong></p></dt><dd><p><code>Require purpose.</code> Occurs when the purpose was not given as part of the upload.</p></dd><dd><p><code>Unknown purpose.</code> Occurs when the purpose was not a valid option.</p></dd><dd><p><code>Image checksum failed.</code> Occurs when the upload_checksum is not equal to the MD5 checksum of the uploaded file.</p></dd><dt><p><strong>500 Internal Server Error</strong></p></dt><dd><p><code>Failed to upload image.</code> Occurs when the request could not be completed by the server.</p></dd></dl>

<h2 id="getmediagenerateahrefgetmediagenerateidgetmediagenerateclassdeeplinka">GET /media/generate <a href="#GET /media/generate" id="GET /media/generate" class="deep-link">#</a></h2>

<p>Controller. Generates and returns a 302 Found (redirect) to the image in the desired format. <strong>Does not require an API key or signature.</strong></p>

<p>The Okanjo platform generally lazy-loads media on demand. URI's to this route may be included in media embeds.</p>

<h3 id="queryparameters">Query Parameters</h3>

<dl class="inline-def"><dt><p><code>id</code></p></dt><dd><p><code>int</code> ID of the media image</p></dd><dt><p><code>size</code></p></dt><dd><p><code>string</code> The size of the image to fetch. See <a href="Media.html#sizedescriptions">Size Descriptions</a>.</p></dd><dt><p><code>format</code></p></dt><dd><p><code>string</code> The format of the image to fetch. See <a href="Media.html#sizedescriptions">Size Descriptions</a>.</p></dd></dl>

<h3 id="returns">Returns</h3>

<p>Returns 302 Found (redirect) with Location of the URL of the image on the Okanjo CDN.</p>

<h3 id="errors">Errors</h3>

<dl><dt><p><strong>400 Bad Request</strong></p></dt><dd><p><code>Missing one or more parameters.</code> Occurs when <code>id</code>, <code>size</code>, or <code>format</code> were not given.</p></dd><dt><p><strong>404 Not Found</strong></p></dt><dd><p><code>Media not found.</code> Occurs when the given media index was not found.</p></dd><dd><p><code>Format not found.</code> Occurs when the given format was not valid.</p></dd><dd><p><code>Size not found.</code> Occurs when the given size was not valid.</p></dd><dt><p><strong>500 Internal Server Error</strong></p></dt><dd><p><code>Failed to generate image. Try again?</code> Occurs when something went wrong and the image could not be generated or located. Trying again may resolve the issue, but who knows. Anything is possible.</p></dd><dd><p><code>There was a problem handling your request.</code> Occurs when something went wrong, and we don’t know exactly what it was.</p></dd></dl>
                <hr />
                <small>Documentation generated by <a href="https://github.com/millermedeiros/mdoc">mdoc</a>.</small>
            </div>
        </div>
        <script src="assets_/js/lib/jquery.js"></script>
        <script src="assets_/js/lib/syntax-highlighter/shCore.js"></script>
        <script src="assets_/js/lib/syntax-highlighter/shAutoloader.js"></script>
        <script src="assets_/js/main.js"></script>
    </body>
</html>

