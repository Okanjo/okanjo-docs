<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>General Semantics : Okanjo API Core Specification</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="assets_/css/shCore.css">
        <link rel="stylesheet" href="assets_/css/shThemeDefault.css">
        <link rel="stylesheet" href="assets_/css/main.css">
    </head>
    <body data-root-path="">
        <div id="wrapper">
            <div id="content">

<ul id="topnav">
    <li><a href="index.html">Index</a></li>
    <li><a href="#toc">TOC</a></li>
</ul>
<p>The Okanjo API is a RESTful web service for the restless web.</p>

<p>All API calls require an API key, which identifies the application using the API. API URI's are signed using a shared
secret passphrase. This adds a layer of security between your application and Okanjo. <strong>Never share your passphrase</strong>.</p>

<h1 id="generalsemantics">General Semantics</h1>

<p>Here are a few guidelines when working with the API.</p>

<h2 id="tableofcontentsahreftocnametocclassdeeplinka">Table of Contents <a href="#toc" name="toc" class="deep-link">#</a></h2>

<ul>
<li><a href="#Data Type">Data Type</a></li>
<li><a href="#Trailing Slashes">Trailing Slashes</a></li>
<li><a href="#SSL Encryption">SSL Encryption</a></li>
<li><a href="#API Access">API Access</a></li>
<li><a href="#User Tokens">User Tokens</a></li>
</ul>

<h2 id="datatypeahrefdatatypeiddatatypeclassdeeplinka">Data Type <a href="#Data Type" id="Data Type" class="deep-link">#</a></h2>

<p>All of our responses are currently returned in JSON. Requests made to the API generally take name-value pairs in the
URI and the entity body, standard form encoded.</p>

<p>API routes currently do not accept JSON in the entity body.</p>

<h2 id="trailingslashesahreftrailingslashesidtrailingslashesclassdeeplinka">Trailing Slashes <a href="#Trailing Slashes" id="Trailing Slashes" class="deep-link">#</a></h2>

<p>As a general rule, do not include trailing slashes on requests. We do not honor requests to resources that include
trailing slashes.</p>

<h1 id="security">Security</h1>

<p>We value security of our services as much as our customers do. Weâ€™ve taken the following steps to ensure data quality and safety.</p>

<h2 id="sslencryptionahrefsslencryptionidsslencryptionclassdeeplinka">SSL Encryption <a href="#SSL Encryption" id="SSL Encryption" class="deep-link">#</a></h2>

<p>All API requests must be sent over an encrypted SSL connection. HTTP requests are not be honored.</p>

<h2 id="apiaccessahrefapiaccessidapiaccessclassdeeplinka">API Access <a href="#API Access" id="API Access" class="deep-link">#</a></h2>

<p>API credentials provisioned by the Okanjo consist of a API key and a API passphrase. The API passphrase is used as the
salt in the HMAC-SHA-256 algorithm to sign an API request. For example:</p>

<ol>
<li><p>Original API URI:</p>

<blockquote>
  <p><code>request = /request?key=xxxx...</code></p>
</blockquote></li>
<li><p>Append the entity body of the request to the URI (can be empty):</p>

<blockquote>
  <p><code>temp = request + entityBody</code></p>
</blockquote></li>
<li><p>Calculate signature checksum using HMAC-SHA-256:</p>

<blockquote>
  <p><code>signature =</code><a href="http://code.google.com/p/crypto-js/#Quick-start_Guide">HmacSHA256</a><code>(temp, password)</code></p>
</blockquote></li>
<li><p>Append the signature to the URI:</p>

<blockquote>
  <p><code>final = /request?key=xxxx...&amp;signature=e7e075fc...7d65a3d7b</code></p>
</blockquote></li>
</ol>

<p><strong>Notes about the key, signature and query string parameters:</strong></p>

<ul>
<li>The <strong><code>key</code></strong> parameter may occur anywhere in the original query string.</li>
<li>The <strong><code>signature</code></strong> parameter must be <em>appended</em> to the final query string.</li>
<li>Always append the entity body (e.g. POST/PUT data) to the request string before calculating the signature. No separator should be used.
<ul><li>When sending <a href="http://tools.ietf.org/html/rfc2388">multi-part form data</a> to the API (e.g. media file uploads), do not include the entity body in the signature calculation.</li></ul></li>
<li>Failing to provide a valid API key, signature, or not signing the request properly, will result in a <strong><code>HTTP 400 Bad Request</code></strong> response.</li>
<li>API keys are directly associated with a brand, meaning that the API will assume the branding associated with the API key.</li>
</ul>

<h2 id="usertokensahrefusertokensidusertokensclassdeeplinka">User Tokens <a href="#User Tokens" id="User Tokens" class="deep-link">#</a></h2>

<p>Some API routes require a user context. In order to use these routes, the user must have authenticated with the API
and have received a user_token. User tokens expire after being neglected for 45 minutes. Performing any API call with a
user token attached will reset its timeout period.</p>

<p>Currently, there is no operation that will destroy or expire a user token.</p>

<p>It is safe to attach user tokens to requests even if they do not necessarily require them. If fact, it's encouraged!</p>

<h3 id="toobtainausertoken">To obtain a user token:</h3>

<ol>
<li><p>Authenticate the user to start session using /user/login:</p>

<blockquote>
  <p><code>POST /users/login</code></p>
</blockquote></li>
<li><p>The login context received will contain user_token:</p>

<blockquote>
  <p><code>4d03a38ce5e03f3...338ed6e15a0635a</code></p>
</blockquote></li>
<li><p>Use the token to send back to API calls that require a valid user token.</p></li>
</ol>

<h4 id="example">Example</h4>

<p>The following shows an example of an API request that also sends a user token.</p>

<p><ol>
<li>Build the request URI:</p>

<blockquote>
    <code>GET /request?key=xxxx&amp;user_token=yyyy</code></li>
  <li>Sign the request URI:
    <code>GET /request?key=xxxx&amp;user_token=yyyy&amp;signature=zzzz</code></li>
  <li>Execute the request</li>
  </ol>
  <h1 id="uniqueidentifiers">Unique Identifiers</h1>
</blockquote>

<p>Resources identifiers generally use numeric unsigned numbers.</p>

<blockquote>
  <p><strong>This may change in future versions of the API.</strong></p>
</blockquote>

<h1 id="namingconventions">Naming Conventions</h1>

<p>As a general rule, we use underscore_cased parameters when working with the API. This applies to query parameters,
entity parameters and resource fields</p>

<h1 id="postingandputing">POSTing and PUTing</h1>

<p>When POSTing or PUTing new resources, all required name-value pairs must be given.</p>

<p>However, when PUTing on existing resources, you can typically only send name-value pairs of the fields you wish to
update. Don issue a PATCH request, since Okanjo will ignore them.</p>

<h1 id="globalparameters">Global Parameters</h1>

<p>Please see the <a href="Globals.html">Globals</a> section for information on global query parameters.</p>

<h1 id="constantsandenumerations">Constants and Enumerations</h1>

<p>Please see the <a href="Constants.html">Constants</a> section for information on constants and enumerations.</p>
                <hr />
                <small>Documentation generated by <a href="https://github.com/millermedeiros/mdoc">mdoc</a>.</small>
            </div>
        </div>
        <script src="assets_/js/lib/jquery.js"></script>
        <script src="assets_/js/lib/syntax-highlighter/shCore.js"></script>
        <script src="assets_/js/lib/syntax-highlighter/shAutoloader.js"></script>
        <script src="assets_/js/main.js"></script>
    </body>
</html>

