<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Users : Okanjo API Core Specification</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="assets_/css/shCore.css">
        <link rel="stylesheet" href="assets_/css/shThemeDefault.css">
        <link rel="stylesheet" href="assets_/css/main.css">
    </head>
    <body data-root-path="">
        <div id="wrapper">
            <div id="content">

<ul id="topnav">
    <li><a href="index.html">Index</a></li>
    <li><a href="#toc">TOC</a></li>
</ul>
<h1 id="users">Users</h1>

<p>Represents an account on the Okanjo.</p>

<h1 id="objects">Objects</h1>

<ul>
<li><a href="Objects.html#LoginContext"><code>LoginContext</code></a> – Login context given upon successfully authenticating a user.</li>
<li><a href="Objects.html#User"><code>User</code></a> – Private user object.</li>
<li><a href="Objects.html#UserProfile"><code>UserProfile</code></a> – Public user object.</li>
</ul>

<h1 id="routes">Routes</h1>

<h2 id="tableofcontentsahreftocnametocclassdeeplinka">Table of Contents <a href="#toc" name="toc" class="deep-link">#</a></h2>

<ul>
<li><a href="#POST /users/login">POST /users/login</a></li>
<li><a href="#POST /users/forgot-password">POST /users/forgot-password</a></li>
<li><a href="#GET /users/{id}">GET /users/{id}</a></li>
<li><a href="#PUT /users/{id}">PUT /users/{id}</a></li>
<li><a href="#POST /users/{id}/set-password">POST /users/{id}/set-password</a></li>
</ul>

<h2 id="postusersloginahrefpostusersloginidpostusersloginclassdeeplinka">POST /users/login <a href="#POST /users/login" id="POST /users/login" class="deep-link">#</a></h2>

<p>Controller. Registers a new user or authenticates an existing user.</p>

<h3 id="entitynvpparameters">Entity NVP Parameters</h3>

<dl class="inline-def"><dt><p><code>action</code></p></dt><dd><p><code>enum</code> Required. See <a href="Constants.html#LoginAction"><code>LoginAction</code></a>.</p></dd><dt><p><code>facebook_token</code></p></dt><dd><p><code>string (255)</code> Facebook access_token value. Required for action <code>loginFacebook</code>, <code>registerFacebook</code></p></dd><dt><p><code>facebook_id</code></p></dt><dd><p><code>string (64)</code> Facebook user id, usually numeric. Required for action <code>loginFacebook</code>, <code>registerFacebook</code></p></dd><dt><p><code>email</code></p></dt><dd><p><code>string (255)</code> User contact email address. Required for <code>loginEmailPassword</code>, <code>registerEmailPassword</code>, <code>checkoutAsGuest</code></p></dd><dt><p><code>password</code></p></dt><dd><p><code>string (6-max)</code> Account password, Required for <code>loginUsernamePassword</code>, <code>loginEmailPassword</code></p></dd><dt><p><code>username</code></p></dt><dd><p><code>string (2-20)</code> Account username, unique to Okanjo. Required for <code>loginUsernamePassword</code>, <code>registerEmailPassword</code>, <code>registerFacebook</code></p></dd><dt><p><code>first_name</code></p></dt><dd><p><code>string</code> User’s first name. Required for <code>registerEmailPassword</code>, <code>registerFacebook</code>, <code>checkoutAsGuest</code></p></dd><dt><p><code>last_name</code></p></dt><dd><p><code>string</code> User’s last name. Required for <code>registerEmailPassword</code>, <code>registerFacebook</code>, <code>checkoutAsGuest</code></p></dd><dt><p><code>birthday</code></p></dt><dd><p><code>date (18-115yrs)</code> User’s birthday. Required for <code>registerEmailPassword</code>, <code>registerFacebook</code></p></dd><dt><p><code>zip</code></p></dt><dd><p><code>string</code> Mailing zipcode. Required for <code>registerEmailPassword</code>, <code>registerFacebook</code></p></dd><dt><p><code>gender</code></p></dt><dd><p><code>string enum</code> User’s gender. Required for <code>registerEmailPassword</code>, <code>registerFacebook</code>. One of the following values: <code>male</code>, <code>female</code>, <code>other</code></p></dd><dt><p><code>meta</code></p></dt><dd><p><code>string[]</code>  Array of key/value properties to attach to the object. Metadata is per-API key.</p></dd></dl>

<h3 id="returns">Returns</h3>

<p><a href="Objects.html#LoginContext"><code>LoginContext</code></a> object.</p>

<h3 id="errors">Errors</h3>

<dl><dt><p><strong>400 Bad Request</strong></p></dt><dd><p><code>Invalid field: {field}</code> Occurs during registration when the given field was invalid.</p></dd><dd><p><code>Unknown login type.</code> Occurs when the given action parameter is invalid.</p></dd><dd><p><code>Invalid login.</code> Occurs when one or more required fields for Guest Checkout were not valid.</p></dd><dt><p><strong>401 Unauthorized</strong></p></dt><dd><p><code>Invalid login.</code> Occurs when the login attempt failed due to invalid parameters or credentials.</p></dd><dd><p><code>Facebook did not authorize the login.</code> Occurs when the user authorization with Facebook failed.</p></dd><dt><p><strong>409 Conflict</strong></p></dt><dd><p><code>User already exists.</code> Occurs when attempting to register an account that already exists.</p></dd><dt><p><strong>500 Internal Server Error</strong></p></dt><dd><p><code>System error.</code> Occurs when an exception occurs.</p></dd><dt><p><strong>501 Not Implemented</strong></p></dt><dd><p><code>Twitter login not implemented yet.</code> NOR WILL IT EVER BE. (╯°□°）╯︵ ┻━┻</p></dd></dl>

<h2 id="postusersforgotpasswordahrefpostusersforgotpasswordidpostusersforgotpasswordclassdeeplinka">POST /users/forgot-password <a href="#POST /users/forgot-password" id="POST /users/forgot-password" class="deep-link">#</a></h2>

<p>Controller. Starts the workflow for a user to recover access to their account. Shoots an email to them with a confirmation code.</p>

<h3 id="entitynvpparameters">Entity NVP Parameters</h3>

<p>Specify only one of the following. Specifying both will blow up.</p>

<dl class="inline-def"><dt><p><code>username</code></p></dt><dd><p><code>string</code> The username of the user to attempt to recover.</p></dd><dt><p><code>email</code></p></dt><dd><p><code>string</code> The registered email address of the user to attempt to recover.</p></dd></dl>

<h3 id="returns">Returns</h3>

<p>Generic <a href="Globals.html#Default Response Object"><code>Success</code></a> object.</p>

<h3 id="errors">Errors</h3>

<dl><dt><p><strong>400 Bad Request</strong></p></dt><dd><p><code>Please supply username or email</code> Occurs when both or neither username or email fields are given.</p></dd><dt><p><strong>404 Not Found</strong></p></dt><dd><p><code>User not found</code> Occurs when the given user is not found.</p></dd><dt><p><strong>500 Internal Server Error</strong></p></dt><dd><p><code>System error.</code> Occurs when an exception occurs.</p></dd></dl>

<h2 id="getusersidahrefgetusersididgetusersidclassdeeplinka">GET /users/{id} <a href="#GET /users/{id}" id="GET /users/{id}" class="deep-link">#</a></h2>

<p>Resource. Gets information about a user. <strong>Requires user level authentication.</strong></p>

<p>If the user is manageable by the requesting user, complete information is returned, otherwise public profile information is returned.</p>

<h3 id="queryparameters">Query Parameters</h3>

<p><em>Fields &amp; Includes</em></p>

<dl class="inline-def"><dt><p><code>fields</code></p></dt><dd><p><code>csv</code> When given, only returns the given fields. Can also can specify fields on embedded objects.</p></dd><dt><p><code>embed</code></p></dt><dd><p><code>csv</code> When given, includes the additional resources. Accepts: <code>addresses</code>, <code>cards</code>, <code>stores</code>, <code>causes</code>, <code>media</code>.</p></dd></dl>

<h3 id="returns">Returns</h3>

<p><a href="Objects.html#UserProfile"><code>UserProfile</code></a> if requesting another user or <a href="Objects.html#User"><code>User</code></a> if requesting user is the same as the requesting <code>user_token</code> user.</p>

<h3 id="errors">Errors</h3>

<dl><dt><p><strong>404 Not Found</strong></p></dt><dd><p><code>User not found.</code> Occurs when the specified user id does not exist.</p></dd><dt><p><strong>500 Internal Server Error</strong></p></dt><dd><p><code>Unable to retrieve user.</code> Occurs when the request could not be fulfilled.</p></dd></dl>

<h2 id="putusersidahrefputusersididputusersidclassdeeplinka">PUT /users/{id} <a href="#PUT /users/{id}" id="PUT /users/{id}" class="deep-link">#</a></h2>

<p>Resource. Updates a user account. <strong>Requires user level authentication.</strong></p>

<h3 id="entitynvpparameters">Entity NVP Parameters</h3>

<dl class="inline-def"><dt><p><code>avatar_media_id</code></p></dt><dd><p><code>int</code> ID of the media image to use for the user avatar.</p></dd><dt><p><code>birthday</code></p></dt><dd><p><code>date time</code> The date in which the user was born.</p></dd><dt><p><code>email</code></p></dt><dd><p><code>string (255)</code> The email address in which to contact the user.</p></dd><dt><p><code>facebook_id</code></p></dt><dd><p><code>int</code> The user’s Facebook ID number.</p></dd><dt><p><code>facebook_token</code></p></dt><dd><p><code>string (255)</code> The user’s Facebook OAuth token.</p></dd><dt><p><code>gender</code></p></dt><dd><p><code>string enum</code> The user’s gender preference.</p></dd><dt><p><code>first_name</code></p></dt><dd><p><code>string (255)</code> The user’s first name.</p></dd><dt><p><code>last_name</code></p></dt><dd><p><code>string (255)</code> The user’s last name.</p></dd><dt><p><code>zip</code></p></dt><dd><p><code>string (10)</code> The user’s default location (postal code).</p></dd><dt><p><code>meta</code></p></dt><dd><p><code>string[]</code>  Array of key/value properties to attach to the object. Metadata is per-API key. Anything included will replace any existing properties on the object.</p></dd></dl>

<h3 id="returns">Returns</h3>

<p>Generic <a href="Globals.html#Default Response Object"><code>Success</code></a> result.</p>

<h3 id="errors">Errors</h3>

<dl><dt><p><strong>400 Bad Request</strong></p></dt><dd><p><code>Invalid field: {field}</code> Occurs when the given field was not valid.</p></dd><dd><p><code>Could not confirm Balanced account URI. Invalid URI?</code> Occurs when the given balanced<em>account</em>uri could not be confirmed due to a third-party communication error.</p></dd><dd><p><code>Cannot set payout preference to Balanced because you have not setup any bank accounts yet.</code> Occurs when the payout preference was set but no payout methods were configured yet.</p></dd><dt><p><strong>401 Unauthorized</strong></p></dt><dd><p><code>Insufficient privileges for this operation.</code> Occurs when the request did not carry sufficient privileges to perform the operation. Trying with different credentials could correct the problem.</p></dd><dt><p><strong>403 Forbidden</strong></p></dt><dd><p><code>Insufficient privileges for this operation.</code> Occurs when the request is attempting to attach a bank account associated with another account.</p></dd><dt><p><strong>500 Internal Server Error</strong></p></dt><dd><p><code>Unable to handle request.</code> Occurs when the request could not be fulfilled.</p></dd></dl>

<h2 id="postusersidsetpasswordahrefpostusersidsetpasswordidpostusersidsetpasswordclassdeeplinka">POST /users/{id}/set-password <a href="#POST /users/{id}/set-password" id="POST /users/{id}/set-password" class="deep-link">#</a></h2>

<p>Controller. Updates the user account’s password. Changing passwords do not affect active user tokens. <strong>Requires user level authentication.</strong></p>

<h3 id="entitynvpparameters">Entity NVP Parameters</h3>

<dl class="inline-def"><dt><p><code>new_password</code></p></dt><dd><p><code>string</code> The new password to use for user name/email login requests.</p></dd></dl>

<h3 id="returns">Returns</h3>

<p>Generic <a href="Globals.html#Default Response Object"><code>Success</code></a> result.</p>

<h3 id="errors">Errors</h3>

<dl><dt><p><strong>401 Unauthorized</strong></p></dt><dd><p><code>Insufficient privileges for this operation.</code> Occurs when the request did not carry sufficient privileges to perform the operation. Trying with different credentials could correct the problem.</p></dd><dt><p><strong>500 Internal Server Error</strong></p></dt><dd><p><code>Failed to update password</code> Occurs when the request could not be fulfilled.</p></dd></dl>
                <hr />
                <small>Documentation generated by <a href="https://github.com/millermedeiros/mdoc">mdoc</a>.</small>
            </div>
        </div>
        <script src="assets_/js/lib/jquery.js"></script>
        <script src="assets_/js/lib/syntax-highlighter/shCore.js"></script>
        <script src="assets_/js/lib/syntax-highlighter/shAutoloader.js"></script>
        <script src="assets_/js/main.js"></script>
    </body>
</html>

